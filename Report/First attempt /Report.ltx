\documentclass[a4paper,11pt]{report}
\usepackage{color}
\usepackage{pdfpages}
\usepackage{graphicx}
\graphicspath{{./Images/Design_chapter/}{./Images/Intro/}{./Images/Appendix/}{./Images/Manufacturing_chapter/}{./Images/Testing_chapter/}{./Images/Conclusion/}}
\usepackage{subcaption}
\usepackage{wrapfig}
\usepackage[export]{adjustbox}
\usepackage{geometry}
\usepackage{setspace}
\usepackage{adjustbox}
\usepackage{amsmath}
\usepackage{textgreek}
\usepackage{authblk}
\usepackage[british]{babel}
\usepackage{url}
\usepackage{doi}
\usepackage{siunitx}
\usepackage{textcomp}
\usepackage{hyperref}
\usepackage[utf8]{inputenc}% for appendix
\usepackage{appendix} %for appendix
\usepackage[square,numbers]{natbib} %the big one
\usepackage{titlepic}
\usepackage[none]{hyphenat}
\usepackage{helvet}
\usepackage[section]{placeins}
\renewcommand{\familydefault}{\sfdefault}
\doublespacing
\geometry{legalpaper, portrait, margin=2cm}
\begin{document}
\setlength{\parindent}{0pt} %No indent in paragraphs
\setlength{\parskip}{1\baselineskip} % double line spacing at the end or a paragraph

\title{Open Science Hardware Setup for investigating the Stability of Organic Solar Cells}
\author{Samuel Mendis}
\affil{Department of Engineering Science, University of Oxford}
\date{\today}
\maketitle
\pagenumbering{roman}
\pagebreak

\begin{abstract}

In order to develop next generation organic solar cells, laboratory research needs to be conducted to reduce degradation as well as increase efficiency. Accurately measuring organic solar cell degradation is difficult and there are not many affordable set-ups available to conduct this type of research. This project developed a set-up which can be used to further organic solar cell degradation research. 

The set-up designed is a leakproof aluminium chamber which has a glass window, a 3D printed holder located inside for the substrate to sit on, 3 PCBs to control the measurements and internal environment of the chamber as well as a raspberry pi which runs the code to control the measurements and internal environment. Simulations show that the substrate temperature (which holds the organic solar cells) can reach up to 120$^o$C, while a leak test conducted indicates there is no leakage into or out of the chamber when submerged in water. 

The chamber is not fully complete due to COVID-19 complications, however, the report clearly lays out the further work needed to ensure that the chamber has the capability to measure and degrade organic solar cells. 


\end{abstract}

\renewcommand{\abstractname}{Acknowledgements}
\begin{abstract}
I would like to acknowledge and thank, my supervisors Professor Stephen Morris and Professor Moritz Riede, for their continued help and support throughout the project, alongside their commitment to ensuring this project is affected as minimally as possible by COVID-19. I would also like to thank Peter Walters, for his assistance with the 3D printing during the project and Stuart Higgs for his guidance with PCB development. Lastly, I would like to thank Dr. Greyson Christophoro for his time and help with many different aspects of this project. 
\end{abstract}

\tableofcontents
\pagebreak

\pagenumbering{arabic}
\chapter{Introduction}
The energy outlook for the 21st century is almost certainly going to be renewable. With the World’s largest economies pledging to be carbon neutral within this century, the energy they require needs to be renewable. Solar energy is one of the answers to this problem; the sun is a source of inexhaustible free energy which can be harnessed to address the needs of the world \cite[p.~894]{RN82}

Currently the market leader in solar cells are crystalline silicon photovoltaics which hold a dominant 95\% market share in the solar energy sector \cite{RN54}. Commercial silicon solar cell modules have greater than 20\% efficiencies. To disrupt this market organic solar cells need to provide versatile light-weight devices which have little material consumption and low temperature processing, while ensuring similar efficiencies to their silicon counterparts \cite{RN54}. This, alongside the fact that the materials required for organic photovoltaics are already widely manufactured, means that they have the potential to be significantly lower cost than their silicon counterparts \cite[p.~54]{RN81}. However, the current problems with organic solar cells boil down to long term stability, low power outputs and lower efficiencies relative to silicon photovoltaics \cite{RN54}. Presently, singe organic solar cells have efficiencies of around 18\%, with researchers believing that efficiencies of 20\% are achievable with both laboratory and commercial modules \cite{RN54}. This project looks at creating a method to help solve the issue of long-term stability by developing a low-cost system which can simulate a lifetime (10-20 years) of outdoor degradation in a matter of months.

\begin{figure}[h]
\hfill\includegraphics[width=0.5\linewidth]{IV}\hspace*{\fill}
\caption{IV characteristics of a standard Photovoltaic Cell, taken from \cite{RN84}.}
\label{fig:IV}
\end{figure}

Solar cells are semiconductor devices which exploit the photoelectric effect to extract energy from a light source. The Current/Voltage graph for a conventional solar cell is shown in Figure \ref{fig:IV}. The Open Circuit Voltage (V$_{oc}$) and Short Circuit Current (J$_{sc}$) are useful to categorise different solar cells as they provide values which can be related to the maximum power extraction using Fill Factor. Fill Factor is defined below in Equation \ref{eq:FF} with P$_{max}$ indicating the maximum power point shown in Figure\ref{fig:IV}. 

\begin{equation}\label{eq:FF}
FF = \frac{P_{max}}{V_{oc}J_{sc}}
\end{equation}

An important aspect of this project is its ability to contribute to the relevant research worldwide. Therefore, the decision was taken to make everything relating to this project opensource, as well as attempt to use opensource software and open-hardware to create this testing chamber. Another key goal is to create a testing set up which can easily be modified to suit the needs of the researchers using it, which brings another important tenant to this project of modularity. Ideally this the set up will have key components which will not be altered, while there will be other elements that will be easily modifiable and editable. 


\section{Literature Review}
\label{sec:lit}
In order to provide a device to add to the field of degradation devices for organic solar cells, a thorough literature review was conducted and modified throughout the project. The main objective of this project was to provide the AFMD (Advanced Functional Materials and Devices) research group, within the University of Oxford Physics Department, with a device that created different operating conditions to degrade organic photovoltaic cells. 


There are multiple degradation mechanisms which cause the short lifetimes of organic solar cells\cite[p.~141]{RN58}. The ones that the system will try and measure the effect of are: diffusion of water vapour into the active layer of the solar cell, diffusion of oxygen into the active layer of the solar cell and operation under high temperatures. High temperature stability is important as solar cells are exposed to direct sunlight, meaning that they will absorb heat radiation alongside light radiation exposing them to high temperatures \cite{RN79}.Other degradation mechanisms will also play a part such as photochemical degradation by UV light and oxygen \cite[p.~106]{RN57}. 

An important factor for the entire set up is to ensure that these degradations are measurable, thereby requiring careful control of the ambient conditions. This meant that a container was needed that would not let in ambient air (due to the oxygen and water content) as well as have a controllable chemical and physical atmosphere. Degradation experiments are essential in the testing of solar cells; therefore, it made sense to try and find any systems that were designed to target similar objectives to that of the chamber to be designed in this project. In 2015 Jaffery et al. \cite{RN59} published a paper outlining a similar setup that was designed for the testing of Photovoltaics (PVs). This design incorporated temperature control and the ability to vary the ambient illumination conditions. The set-up is shown in the Figure \ref{fig:set_upHT9} \cite[p.~3,4]{RN59} below.

\begin{figure}[h]
\begin{subfigure}{0.5\textwidth}
\includegraphics[width=0.9\linewidth]{HT9_Fig1}
\caption{The Test chamber and relevant accessories used in the research}
\end{subfigure} \begin{subfigure}{0.5\textwidth}
\includegraphics[width=0.9\linewidth]{HT9_Fig2}
\caption{Schematic of the test chamber and relevant accessories used in the research}
\end{subfigure}
\caption{A device developed by Jaffery et al.\cite{RN59} to test organic photovoltaics}
\label{fig:set_upHT9}
\end{figure}



This set-up provided a solid basis on which to develop the system required to meet the goals of this project, however, it lacks the simplicity of what is required. There are multiple large scale components which mean a complicated building and testing process. For the chamber this project requires, it needs to be easily replicable worldwide, thereby allowing it to contribute to the development of OPV(Organic Photovoltaic) technology. 


Another example is by Lai and Potters \cite{RN43} which referenced a large scale industrial chamber. This chamber also provided different conditions for testing a photovoltaic cell. This module was manufactured by Envirotriks (now Weiss Technik) who specialise in the manufacturing of environmental testing equipment. Their technology ranges from aerospace to biological environmental applications. On further investigation, their products were large scale expensive modules which would not be applicable to one of the key goals of this project, being easily replicable worldwide. 

Adding to this, a further set-up was used in Pearson et al \cite{RN62} experiments on the degradation of organic solar cells. This set up ensured that the cells were loaded into the container while in a glovebox, then held at an overpressure to ensure atmospheric gases (specifically water vapour and oxygen) did not leak into the container. Furthermore, the atmospheric make-up of the container was monitored by a gas analyser and the cells measured using a Keithley source meter \cite [P.~227]{RN62}. This chamber is the closest to what was specified in my project description; however, the gas make-up monitoring adds further complexity to the chamber which again reduces the widespread replication of the system worldwide.  

These systems worked well for their goals; however, they do not fully address the needs of this project. Despite this, there were key components in all three set ups which I took inspiration from for my designs. From Figure \ref{fig:set_upHT9} the small container is something which appealed to me, especially if it were tweaked to ensure ease of set up. Furthermore, from the commercial modules, the holistic nature of all the components was something that was desirable, as this would ensure that the container would be suitable for all manner of testing. From Pearson et al \cite {RN62}, I thought the idea of overpressure to prevent leakage was clever, as well as making the device small enough to load in a glovebox. These were all features which will all be incorporated into the chamber 

The systems discussed have all influenced the specification for the chamber. However, one of the key features is to align closely with the standard for testing organic solar cells. Different papers reference different standards, a decision was made to see where they overlapped and create a container that was able to meet as many standards as possible. Zhang et al \cite[p.~1]{RN51} talk about the IEC61646 standard developed by the International Electrochemical Committee. This testing standard includes: “ 1000 h damp heat (DH) test at 85$^o$C and 85\% humidity, 200 cycles of thermal cycling (TC) from $-$40 to $+$85$^o$C, and a sequence test consisting of UV exposure, 50 cycles of TC, and 10 cycles of humidity freeze (HF) from $-$40 to $+$85 $^o$C at 85\% humidity. After finishing each test, modules are then characterised to determine device efficiency.”

Further to the IEC61646 is the guidelines referenced in Reese et al. \cite[p.~1254]{RN53}[HT 3 P1254]. These were developed at the International Summit on Organic and Hybrid Photovoltaic Stability in the years 2008. 2009 and 2010. These 3 guidelines (ISOS 1,2,3) show different methods for testing solar cell degradation, some of which can be seen in Figure \ref{fig:HT3_fig2} \cite[p.~1255]{RN53}. 


Figure \ref{fig:HT3_fig2} has been taken from Reese et al. \cite{RN53} and outlines some of the different testing conditions for organic solar cells. As can be seen, the guidelines are similar to those referenced in the IEC61646 standard, however, there is more detail on the exact light source, as well as the load the solar cell should be subject to. 

\begin{figure}[ht!]
\hfill\includegraphics[width=0.9\linewidth]{HT3_Fig2}\hspace*{\fill}
\caption{Overview of the different types of testing protocols mentioned in Reese et al.}
\label{fig:HT3_fig2}
\end{figure}


From these two sets of guidelines, basic functionality for the container could be drawn up. This includes: temperature variation with a minimum maximum temperature of 85$^o$C, ability to vary humidity, regular measurement of Voc (open circuit voltage)and Jsc (short circuit current) and light conditions which would vary from a solar simulator to outdoor sunlight to darkness. Both sets of guidelines reference temperatures below ambient room temperature; however, this would require some sort of refrigerant running through the device, connected to pumping systems and a heat exchanger. This would cause the box to be particularly cumbersome as it would require significantly more components, space and complexity meaning it would struggle to fit the requirement of easily replicable. Thereby, the decision was made to not have testing conditions below ambient room temperature and to have a chamber that could exceed the high temperature testing requirements with a substrate temperature of 120$^o$C. 

Another integral consideration was sampling time. For accurate results, it would be desirable to have regular short interval (measurements every minute) measurements of Voc and Jsc. However, due to the differences across different devices and degradation conditions having a singular sampling time would create either too much data, or be too long to create an accurate enough picture of the device. The Figures \ref{fig:O2_deg} and \ref{fig:N2_deg} show the differences in degradation for the same solar cells in different conditions. 

\begin{figure}[h]
\begin{subfigure}{0.45\textwidth}
\includegraphics[width=1\linewidth]{O2_deg}
\caption{Solar cell exposed to dry oxygenated atmosphere\footnotemark,taken from Kawano et al. \cite{RN83}}
\label{fig:O2_deg}
\end{subfigure} 
\begin{subfigure}{0.45\textwidth}
\includegraphics[width=1\linewidth]{N2_deg}
\caption{Solar cell exposed humid nitrogen atmosphere\footnotemark, taken from Kawano et al. \cite{RN83}}
\label{fig:N2_deg}
\end{subfigure}
\caption{Normalised photovoltaic performance characteristics for an unencapsulated solar cells as a function of exposure time. FF is Fill Factor, which represents ratio of maximum power to Jsc$\times$Voc.}
\label{fig:degs}
\end{figure}
From Figures \ref{fig:O2_deg} and \ref{fig:N2_deg} it is clear to see that it would be impossible to create a singular sampling time for different conditions without creating the issues mentioned. This is an important factor that should be considered when designing the measurement system and will be discussed in Section \ref{sec:code_development}. 
\footnotetext[1]{Under continuous white light radiation, with the atmosphere containing 20\% oxygen $<4\%$ relative humidity.}
\footnotetext{Under continuous white light radiation with the atmosphere containing 0\% oxygen and $>40\%$ relative humidity.}

The literature review shows that there are devices available for similar OPV degradation tests, however, none achieve all the goals that this project aims to meet. To prevent unmeasurable degradation the chamber needs to be leakproof to outside air. The chamber should also allow illumination of the cells, using the Air Mass (AM) 1.5 spectrum\footnotemark. There will be no cooling on the chamber, as integrating a cooling system would require expensive and cumbersome equipment reducing the accessibility of the device.This report is split into three chapters, each outlining a key aspect of the project(Design, Manufacturing and Testing), alongside the conclusion which describes further work that could be done to enhance the set-up. 
\footnotetext{The AM1.5 spectrum is the standard ground level solar spectrum used by the American Society for Testing and Materials.}

\chapter{Chamber Design}
\label{chp:design}
The design of the container and associated electronics was a key process in the development of the chamber. This chapter will go through the entire design process, outlining the key aims, decisions and analysis behind the container design. 

During the mechanical design process, there were two different software packages used: OpenSCAD and SOLIDWORKS. OpenSCAD is an open-source software which is compatible with all major computer operating systems. Furthermore, as mentioned in the introduction, using open-source software is a key tenant of this project as it needs to be replicable for teams worldwide. SOLIDWORKS however, is not open-source, but was still used, because there is some key functionality that was needed such as rendering photos, heat simulations and producing engineering drawings. However, as I will lay out further in the chapter, the main designs were completed on OpenSCAD, and they do hold enough information for researchers and engineers elsewhere to replicate without significant difficulty. 

A key consideration was what processes would be needed for the manufacturing of the container. The engineering department has different facilities which could be useful including: a workshop with a CNC\footnote{Computer Numerical Control machine used to accurately machine parts out of a variety of materials.} machine, 3D printers (which could print parts using a range of materials), a mechanical workshop and an electrical workshop. These all were considered when designing the container and each will be mentioned during this chapter. 

During the electrical design process there was more of a conundrum. Due to COVID-19 regulations the design lab was closed (at the time when I needed to conduct electrical designs), meaning that I was unable to access key software (SOLIDWORKS PCB and Electrical) – the favoured software by the electrical workshop. Therefore, an open-source solution needed to be found, the solution was KiCAD. KiCAD was readily accessible, user-friendly and could run on a variety of computers. 

\section{Physical Specification} 
\label{sec:Physical_spec}
The first stage of the design process was to outline a specification for the testing container. These specifications were drawn from the project brief, the literature review and discussion with my supervisor Professor Moritz Riede. The primary specification of the design is outlined below:
\begin{enumerate}
\item{The container must be able to accommodate a 30 mm x 30 mm substrate provided by the AFMD research group;}
\item{The container must be leakproof \footnote{Not allow enough Oxygen and water vapour in from ambient atmosphere to degrade a calcium sample with dimensions 30 mm *30 mm *150 nm over a period of 3 days} to outside air;}
\item{The container must allow electrical connections \footnote{The connections must enable the cell to be controlled/measured by a source meter.} from outside to connect to the substrate for measurements.}
\item{The container must enable the substrate to be heated to a given temperature \footnote{Up to 120$^o$C as mentioned in Section \ref{sec:lit}.};}
\item{The container must have a window allowing light\footnote{The AM1.5 light spectrum} to be shone onto the substrate;}
\item{The container must contain a gas inlet;}
\item{The container should fit into the small glovebox load lock with diameter 150 mm;}
\item{It must be possible to assemble the chamber within a glovebox;}
\end{enumerate}

The desirable goals which would supplement the primary specification are as follows: 
\begin{itemize}
\item{Build a Python based GUI (Graphical User Interface) to enable programmatic testing of the solar cell;}
\item{Enable a programmable atmosphere for the box which should be embedded into the functionality of the GUI;}
\end{itemize}
This specification is a clear guide to what functionality there needs to be within the container, as well as any size limitations. As mentioned in both the introduction and literature review, it is essential for the container to be leakproof, to ensure that the solar cell does not degrade due to atmospheric O2 and water vapour. This would result in flawed results due to the cell having some unmeasured degradation before the experiments even begin. Another important point in the specification is the ability of the cell to be heated to a given temperature*. This functionality is important as its role is to attempt to emulate a lifetime (20 years) of temperature degradation in the space of 3 months. 

The gas inlet is another feature to enhance the degradation. This will be used to create a ‘cocktail’ of different gases (e.g. oxygen and water vapour) to try and emulate lifetime degradation of the solar cell. The last point on the specification is to ensure the ease of use with the AFMD research group. The gloveboxes they use have a small inlet with a diameter of 150 mm, using this would vastly reduce the time needed to insert the solar cell into the testing container. 

These desirable goals are important to ensure the ease of use of the box, as well as to reduce the amount of time needed for setting up and running the container. The programmatic testing of the cell is important as it enables simple running of the chamber, saving time and reducing complexity for those using it. 
\section{Container Model, Mark I}
\label{sec:IMD}
This specification described in Section\label{sec:Physical_spec}provided the structure for the testing container. The literature review showed that there is no comparable devices on the market to the required chamber, thereby requiring innovative design to satisfy the specification. A first iteration of the design is shown below in Figures \ref{fig:plan_iteration1} and \ref{fig:iso_iteration1}. 

\begin{figure}[h]
\begin{subfigure}{0.5\textwidth}
\includegraphics[width=0.9\linewidth]{Design_1}
\caption{Plan View of Model}
\end{subfigure} \begin{subfigure}{0.5\textwidth}
\includegraphics[width=0.9\linewidth]{Design_2}
\caption{Perspective View of Model.}
\end{subfigure}
\caption{Plan and Perspective view of the First Iteration of the Outer Shell.}
\label{fig:plan_iteration1}
\end{figure}
\begin{figure}[h!]
\hfill\includegraphics[width=0.45\linewidth]{Design_3}\hspace*{\fill}
\caption{ Isometric View of the Outer Shell. Label \textbf{a} represents the ‘electronic windows’ where the wires will go, label \textbf{b} represents the holes for the push-fit valves and label \textbf{c} shows the screw holes.}
\label{fig:iso_iteration1}
\end{figure}

This model is supposed to coincide with a smaller module named the Substrate Holder, which is designed to sit within the outer shell, holding the substrate\footnote{The substrate is the component which the solar cells are attached to, with the layout shown in Figure\ref{fig:sub_layout}.}, temperature sensor and heater, shown in Figure \ref{fig:substrate_holder1}. The substrate holder is designed to be a removable component which can be edited to match the substrate provided. During the design process, this module was designed to be 3D printed to ensure low cost and easy modification. In Figure \ref{fig:substrate_holder1} label \textbf{a} represents the hole which the heater is meant to sit inside, while label \textbf{b} represents the 30 mm x 30 mm slot that the substrate will sit in. 

\begin{figure}[h]
\hfill\includegraphics[width=0.45\linewidth]{Design_4}\hspace*{\fill}
\caption{Isometric view of the first iteration of the Substrate Holder.}
\label{fig:substrate_holder1}
\end{figure}

Both the substrate holder and Outer Shell were 3D printed to provide a physical representation of the model (with a photo shown in Figure \ref{fig:3D_print1}). This was because the process was iterative: design, rapid prototype, design, rapid prototype. The reason behind this was to ensure that the design process found potential flaws within the chamber preventing time being wasted in the future where design flaws could impact the entire timeline. This process paid off as after 3D printing the design, it became clear that this design was very small and fiddly, making it difficult to assemble within the glovebox. Moreover, it is clear that there would not be enough room to wire the components in the container. 
\begin{figure}[h]
\hfill\includegraphics[width=0.45\linewidth]{Design_5}\hspace*{\fill}
\caption{3D printed model of the chamber.}
\label{fig:3D_print1}
\end{figure}

\section{Container Models Mark II}
\label{sec:FCM}
To counter the problems described in the previous Section, \ref{sec:IMD}, the following iteration - shown as a CAD model in Figure \ref{fig:outer_final} – fixes the listed problems. The Outer Shell is larger in this model with dimensions 100 mm* 110 mm* 77 mm, with a wall thickness of 16 mm, resulting in more space within the container. Additionally, there was a rethink of the sealing method, to eliminate the need of directly screwing onto glass, risking a break, therefore a lid was constructed for the substrate holder, which would cause the glass window to be sandwiched between 2 O-rings creating an airtight seal. The changes to the outer shell can be seen in Figure \ref{fig:outer_final}, with the new lid shown in Figue \ref{fig:metal_lid_CAD}. 

\begin{figure}[h]
\hfill\includegraphics[width=0.45\linewidth]{Design_6}\hspace*{\fill}
\caption{The Final Outer Shell model.}
\label{fig:outer_final}
\end{figure}

\begin{figure}[h]
\hfill\includegraphics[width=0.45\linewidth]{metal_lid_CAD}\hspace*{\fill}
\caption{The lid which will be used to sandwich the glass plate between 2 o-rings.}
\label{fig:metal_lid_CAD}
\end{figure}

The substrate holder was also modified with the intention of being unique to this particular substrate layout resulting in a more detailed design. The pin layout – which includes the light masks - was provided to me by Dr. Grey Christophoro, a researcher working in the Physics department, and can be seen in Figure \ref{fig:sub_layout}.

\begin{figure}[h]
\hfill\includegraphics[width=0.45\linewidth]{Design_7}\hspace*{\fill}
\caption{The pin layout provided by Dr. Christophoro, the light masks show the area which light should be incident on.}
\label{fig:sub_layout}
\end{figure}


As shown in Figure \ref{fig:sub_layout} the substrate has 10 contact points, meaning that the substrate holder needs to provide a method to cleanly contact the contact points, without hindering the flow of air around the cell\footnote{To ensure that gases that are needed for degradation are able to react with the active layer or electrodes}, or blocking the light incident on the cell surface. The solution was to develop a small lid which would be screwed into the substrate holder, thereby providing downward pressure onto the substrate to ensure clean contacts with the pins. This lid was designed so that the outline did not block any light being incident on the cells. The lid can be seen on top of the substrate holder in Figure \ref{fig:sub_lid}.

\begin{figure}[h]
\hfill\includegraphics[width=0.45\linewidth]{Design_8}\hspace*{\fill}
\caption{The lid used to exert downward pressure on the substrate.}
\label{fig:sub_lid}
\end{figure}

Another important consideration was the ability for the substrate holder to be easily attached to the outer shell within the glovebox. Therefore, the substrate holder needs to have electrical wiring within it, to easily connect up the solar cell with the monitoring device. Conversations with the electrical workshop helped me come up with a simple idea of creating a ‘plug’ which would enable the substrate holder to be connected to wiring that in turn would be connected with the monitoring device. This will be discussed  further in the Testing Chapter, \ref{chp:testing}. 

A further modification is the gap under where the substrate is supposed to sit, this is to encourage gas flow beneath the substrate. Another issue was where the heater and temperature sensor would sit. This led me to place the two holes running through the substrate holder one on top of the other to place the sensor and the heater. These holes were positioned there tactically so that the sensor temperature could be correlated with the predicted substrate temperature by modelling. These changes can be seen in the expanded overall model shown in Figure \ref{fig:blown_up}.

\begin{figure}[ht!]
\hfill\includegraphics[width=0.8\linewidth]{Design_9}\hspace*{\fill}
\caption{The Blown-Up model of the chamber}
\label{fig:blown_up}
\end{figure}

\section{Electrical Specification} 
\label{section:Electrical_spec}

This section will take a more in depth look at the electrical requirements of the chamber. From the pin layout, it is clear that there needs to be 20 wires connected to the cell. For this particular substrate layout, there are 6 separate OPV cells which means a PCB needs to be manufactured which is able to choose which of these cells to measure. Each cell needs to be measured to find the value of the Voc and Jsc recorded with the time, temperature and gas composition the substrate is subjected to. 

Adding to this, a measurement device needed to be chosen, along with a controller to run and record the data. After discussion with the AFMD group, Dr. Christophoro and my supervisors Professors Riede and Morris the following electrical specification was drawn up:

\begin{itemize}
\item[-] The set-up requires a method of differentiating the cell voltages and currents (ideally through the use of a multiplexer);
\item[-] The set-up requires a method of controlling the heat and gas composition within the chamber as well as  the measurement intervals;
\item[-] The set-up requires a method to record Voc and Jsc measurements;
\item[-] The set-up requires a method of measuring the Voc and Jsc;
\item[-] The set-up requires a method of measuring the temperature conditions within the container.
\end{itemize}
This specification is non-exhaustive but does provide a clear structure to what is needed for the successful manufacturing of the chamber.

\section{Electrical Design}
\label{sec:elec_design}

For the control systems, there were two options: a Raspberry Pi or an Arduino. Both have extensive documentation and are relatively inexpensive given their capabilities. To decide which would be more suitable a Multi-Criteria analysis was undertaken with the results shown below:

\begin{table}[ht!]
\centering
\begin{tabular}{c|c|c}
&Raspberry Pi 4 & Arduino Uno Rev3 \\
\hline
Cost & 4 & 10\\
\hline
Simplicity of use & 10 & 5 \\
\hline
Size & 3 &5  \\
\hline 
Adaptability & 20 & 10 \\
\hline
Total & 37 & 30\\
\end{tabular}
\caption{\label{tab:MCA-Pi} The Multicriteria Analysis between the Raspberry Pi and Arduino}.
\end{table}

The cost of a Raspberry Pi 4 from RS- components was \pounds53.22 \cite{RN63}while the cost of the Arduino Uno Rev3 is \pounds20.40 \cite{RN64}. Cost was a factor in my decision, it was not as important as adaptability, yet more important than size, therefore I rated the Arduino with a score of 10, and Raspberry - Pi with a score of 4. The simplicity to use was something that I believe should have the same weighting as cost. From discussions with colleagues, it was clear that running different programs was more difficult on the Arduino due to the fact it stored one program at a time, meaning each time a procedure needed to be changed: the Arduino needed to be plugged in to a computer. The Raspberry-Pi, however, is simpler, it is more like a conventional computer, able to store multiple programs, runs with a modified Linux operating system, thereby creating a simpler system. 

The size was a small factor to consider, thereby the reduced emphasis on scoring. Lastly, adaptability of the device was integral. The device needed to be able to store data, as well as run code which was easily modifiable for those using it. This created a clear divide between the two products as the Raspberry-Pi is by far considered a more ‘rounded’ device compared to an Arduino which is usually used for highly specific applications. 

From the multi-criteria analysis above it is clear that the Raspberry-Pi is the preferred device and thereby was the chosen product for this application. The Raspberry-Pi required electronics which enables the selection of which solar cell was required. After discussions with Dr. Christophoro, I was pointed to some PCB designs in his GitHub repositories \cite{RN65} \cite{RN66} which could be modified to suit my applications. The two schematics of designs that I was directed to are shown in the appendix as Figure \ref{fig:appendix1} and \ref{fig:appendix2}.

These designs needed to be modified for the following reasons. Firstly, the design named Base 8x, was designed to interface with an Arduino, meaning a subsequent header needed to be implemented to ensure that the PCB was able to interface with the Raspberry Pi. Other small modifications include adding resistors and a header for a temperature sensor to be wired in, as well as creating the mounts for a secondary PCB to be mounted (which would hold the Solid-State Relay needed to control the mains powered cartridge heater). 

For rapid testing and prototyping, the decision was made to use the departmental PCB printers. This meant some further changes needed to be made to the PCBs: ensuring that the tracks were routed with large enough profiles to be printed on the departmental printers and modifying the PCB so that it only had two working layers \footnote{The departmental printers can only print a PCB with two layers or less.}. These modifications in the schematic can be seen in the Appendix \ref{fig:appendix3}. 

For the PCB named Solar MUX- schematic shown in appendix as Figure \ref{fig:appendix2} - there needed to be significantly fewer modifications, yet they were still significant. Firstly, the number of relays were reduced from 21 to 17 as only 6 solar cells were being measured rather than 8. Furthermore, there were significant modifications to the routing of the tracks as again this PCB had not been designed to be printed in the engineering department thereby meaning the tracks needed to be made larger. These changes to the schematic can be seen in Figure \ref{fig:appendix4} in the Appendix. 

I also designed a third PCB whose schematic can be seen in the appendix as Figure \ref{fig:appendix5}. This is a small PCB designed to isolate mains current from the board named base, thereby enabling me to run tests without the hazards posed by wiring up to the mains. 

Once these were all designed, they needed to be created into models that were manufacturable. Each PCB had two working layers made of copper, the components to be soldered on were nearly all through-hole mounted for ease of soldering and the tracks were mainly 1 mm thick to make it easy to solder the components onto. Each PCB can be seen from two views in the Figures \ref{fig:Base_3D} , \ref{fig:MUX_3D} , \ref{fig:SSR_3D} .

\begin{figure}[h]
\begin{subfigure}{0.5\textwidth}
\includegraphics[width=0.9\linewidth]{Base_3D_1}
\caption{Front View of PCB named Base,}
\end{subfigure} \begin{subfigure}{0.5\textwidth}
\includegraphics[width=0.9\linewidth]{Base_3D_2}
\caption{Back View of PCB named Base,}
\end{subfigure}
\caption{Model of the PCB named Base.}
\label{fig:Base_3D}
\end{figure}

\begin{figure}[h]
\begin{subfigure}{0.5\textwidth}
\includegraphics[width=0.9\linewidth]{MUX_3D_1}
\caption{Front View of PCB named MUX,}
\end{subfigure} \begin{subfigure}{0.5\textwidth}
\includegraphics[width=0.9\linewidth]{MUX_3D_2}
\caption{Back View of PCB named MUX,}
\end{subfigure}
\caption{Model of the PCB named MUX.}
\label{fig:MUX_3D}
\end{figure}

\begin{figure}[h]
\begin{subfigure}{0.5\textwidth}
\includegraphics[width=0.9\linewidth]{SSR_3D_1}
\caption{Front View of PCB named SSR,}
\end{subfigure} \begin{subfigure}{0.5\textwidth}
\includegraphics[width=0.9\linewidth]{SSR_3D_2}
\caption{Back View of PCB named SSR,}
\end{subfigure}
\caption{Model of the PCB named SSR.}
\label{fig:SSR_3D}
\end{figure}




\section {Code Planning}

Choosing the Raspberry Pi enabled the planning and development of the code. There was some general research through the documentation to understand the ways to use the General-Purpose Input Output header to control electronics (GPIO). From reading the documentation for the GPIO \cite{RN67}, it was clear there were 3 real options for programming language, C, C++ or Python. As someone who has experience in Python, alongside the \emph{extensive} documentation for the GPIO pins in Python \cite{RN68} it was a clear choice to use Python as the programming language. 

Using the library Gpiozero, simple tests were conducted to ensure the different libraries used (such as the multiprocessing library) were compatible with the GPIOzero library. Testing the multiprocessing library involved running multiple LEDs in parallel with each other so that they would be blinking with different time intervals for each blink. This proved that the Gpiozero library worked with the multiprocessing library and enabled the planning of the main script that was going to control the testing container. 

The thought process behind the code architecture was to develop a Graphical User Interphase (GUI) to help the user with the control of the testing container. The GUI would then display specific information while the test was running, enabling a convenient ‘check’ for the user to ensure the test is proceeding as planned. The resultant GUI can be seen as a screen-shot in Figure \ref{fig:GUI_1}.

\begin{figure}[ht!]
\hfill\includegraphics[width=0.47\linewidth]{GUI}\hspace*{\fill}
\caption{The GUI developed as part of the code for the programmatic atmosphere.}
\label{fig:GUI_1}
\end{figure}

There were, however, some problems with this set-up. Once the GUI itself was constructed I was unable to integrate it with the Multiprocessing package. Therefore, the decision was taken to focus on the development of an editable Python script, meaning the  GUI would be left for Future work. This was done to prioritise the construction of the chamber.to be may not meet the supplementary desirable goals (but would be operational), rather than create a container that was 80\% working yet not ready to test solar cells. For this reason, I decided to put the GUI to one side and develop the code so that it was simple to change the parameters of the test from within. 

The chamber designs meet the specification, allowing the movement of the project onto the construction stage. The CAD models were essential to create 3D printed prototypes, allowing the identification of any potential problems (such as the Mark I chamber being too small). The models of the PCBs allow the identification of any components which may have been too small to solder allowing them to be replaced with bigger, easier to solder components. Lastly, the code planning ensured that time was not needlessly spent trying to perfect a GUI, rather the work done ensured the correct prioritisation of work completed in Section \ref{sec:code_development}

\chapter{Chamber Construction}. 
\label{chp:manufacturing}


In this chapter I will be discussing the different stages of manufacturing of the chamber. The manufacturing process is split into three sections in this chapter which cover the manufacturing of the chamber itself, the manufacturing of the PCB and associated electronics as well as the code development. 

From the Gantt chart shown in Figure \ref{fig:Gantt} in the Appendix, the manufacturing (including assembly process was estimated to take 4 least  weeks, this prediction did not include any time that was needed for iterating as well as physically building the components. Unfortunately, due to the second national lockdown in January 2021, alongside longer than expected lead times, the project was delayed compared to the original plan. This can be seen in Figure \ref{fig:Gantt_covid} in the Appendix, where the delays can be seen clearly. 

As mentioned in the Design Chapter, \ref{chp:design}, the plan was to use the engineering department workshops for the manufacturing of all the parts of this chamber. There were some limitations, such as the fact the PCB printing machine could only print 2 layers. However, this was dwarfed by the expertise that I was able to utilise while developing these designs, ensuring that the chamber was constructed to the highest standards. This chapter will discuss the decisions made during the manufacturing process, any modifications made and their impact on the final product. 


\section{Outer Chamber Manufacturing}
This section will discuss the manufacturing of the container itself, including components which were attached to the chamber. From the designs shown in Section \ref{sec:FCM}, engineering drawings were produced and shown to Duncan Constable (the senior workshop technician) who advised me that the inside corners would come out rounded due to the precision of the CNC mill. Furthermore, I was instructed to change the shape of the O-ring ‘gaps’ so that the O-rings would not tear around the sharp corners. 

Another important factor was the material selection. As mentioned previously, the material needed to be impermeable, preferably metal with limited corrosion. Speaking to Duncan about the preference of Aluminium, he suggested Duralumin, which the workshop had an abundance of spare stock and it was the most suitable metal for the CNC miller to manufacture. Dural is a 2000 series Aluminium alloy, (which is impermeable and robust - as the specification requires) with the main materials apart from Aluminium being Copper, Manganese and Magnesium \cite{RN73}. 

\begin{figure}[h!]
\hfill\includegraphics[width=0.5\linewidth]{elec_windows_drawings}\hspace*{\fill}
\caption{The Electrical ‘windows’ part drawing.}
\label{fig:metal_window_drawing}
\end{figure}

The designs were then submitted to the workshop for manufacturing with the drawings shown in Appendix \ref{fig:drawing_1}, \ref{fig:drawing_2}, \ref{fig:drawing_3}. Alongside the parts shown in the appendix, the electronic windows were manufactured from scrap metal using a lathe, with the drawings shown in Figure \ref{fig:metal_window_drawing}. These parts were then modified by hand to create leakproof wire connections between outside the container and within, with the finalised part shown embedded into the container in Figure \ref{fig:metalwindow}. 
\begin{figure}[htb!]
\begin{subfigure}{0.5\textwidth}
\includegraphics[width=0.95\linewidth]{elec_windows_glued}
\caption{The Electrical windows embedded into the chamber.}
\label{fig:metalwindow}
\end{subfigure}\begin{subfigure}{0.5\textwidth}
\includegraphics[width=0.95\linewidth]{safety_relief}
\caption{The Assembly of the push-fit valves.}
\label{fig:safety_relief}
\end{subfigure}
\caption{The assembly of the chamber.}
\end{figure}


As can be seen in Figure \ref{fig:metalwindow}, the wires are glued (using a glue gun) into the metal, meaning that they should not allow any leakage of air through, as well as not allowing short circuit due to the metallic casing. Furthermore, there is glue around the outside of the ring component (labelled a), to prevent leakage of air into the container. The advantage of using a glue gun, is that the glue is a thermoplastic, meaning that if there is an error, it can be heated and removed allowing the continuous modification of the chamber. 

\begin{figure}[ht!]
\begin{subfigure}{0.45\textwidth}
\includegraphics[width=0.9\linewidth]{oring_assem}
\caption{The O-ring glued into the lid of the container.}
\label{fig:oring_assem}
\end{subfigure}\begin{subfigure}{0.45\textwidth}
\includegraphics[width=0.9\linewidth]{acrylic_plate}
\caption{The acrylic plate sandwiched between 2 O-rings.}
\label{fig:acrylic_plate}
\end{subfigure}
\caption{Further figures showing the assembly of the chamber}
\end{figure}

Following the manufacturing of the outer shell, assembly occurred. Firstly, the O-rings needed to be attached to the chamber. Figure \ref{fig:oring_assem} shows the O-ring glued into its slot. The O-rings sandwiched an acrylic plate which was used for the testing of the system (before any expensive glassware was bought) shown in Figure \ref{fig:acrylic_plate}. This assembly concluded with the attachment of the safety relief valves\footnote{The safety relief valve is required in case there is a malfunction with the MFCs causing a large overpressure within the chamber, which could result in an explosive failure causing damage and injury}and push fit valves shown in Figure \ref{fig:safety_relief} sourced from Tameson \cite{RN36} and RS\cite{RN33} respectively.  Lastly, the assembly was completed using small guide pins, labelled in Figure \ref{fig:assembly} alongside the M4 screws used to tighten the lid onto the glass plate thereby creating an airtight seal. The testing of this will be discussed further in the following chapter. 

\begin{figure}[h!]
\hfill\includegraphics[width=0.6\linewidth]{assembly}\hspace*{\fill}
\caption{The fully assembled chamber}
\label{fig:assembly}
\end{figure}

\section{Internal Chamber Manufacturing}
\label{sec:ICM}

This section looks at the manufacturing of the substrate holder, which houses the substrate that contains the organic solar cells. Figures \ref{fig:blown_up} show the designs which were manufactured using the departmental 3D printing machines with ABS (Acrylonitrile Butadiene Styrene) plastic. ABS has a softening point of between 160 – 170$^o$C \cite[p.~744]{RN70}, which is lower than desired for the container, however, this version was used as a test to see if it was possible to insert the electrical contacts into this design. 

Figure \ref{fig:failure} shows my attempts to insert electrical contact pins \cite{RN71} into the substrate holder. This was unsuccessful due to the fact these pins were extremely fiddly to handle, coupled with the very small amount of space I had to solder wires onto the pin while not melting the plastic. This required a rapid solution otherwise the timeline for the project would be delayed. 

\begin{figure}[h!]
\hfill\includegraphics[width=0.5\linewidth]{substrate_fail}\hspace*{\fill}
\caption{The substrate holder with 4 electrical contact pins soldered in place. }
\label{fig:failure}
\end{figure}


The solution was creating a new 3D printed part, with more space for the pins to be inserted and soldered correctly. The new substrate holder would also be made from PEEK (Polyether Ether Ketone) rather than ABS due to its higher MP (260$^o$C) \cite{RN72} allowing soldering of the pins to wires to take place, as well as no deformation within the container. This part was due to be manufactured in the engineering department, however, due to external factors, the production had to be outsourced to Lazer Lines, with the part made from Formlabs High Temp Resin for High Thermal Stability, with the datasheet found at \cite{RN80}. The substrate holder and lid can be seen in Figures \ref{fig:substrate_HT} and \ref{fig:lid_HT}. 

\begin{figure}[h!]
\begin{subfigure}{0.5\textwidth}
\includegraphics[width=0.9\linewidth]{substrate_HT}
\caption{The new substrate holder made from High Temperature Resin}
\label{fig:substrate_HT}
\end{subfigure}\begin{subfigure}{0.5\textwidth}
\includegraphics[width=0.9\linewidth]{lid_HT}
\caption{The new lid made from High Temperature Resin}
\label{fig:lid_HT}
\end{subfigure}
\end{figure}


\section{PCB Manufacturing}

As mentioned in Section \ref{sec:elec_design}, the PCB was designed to be manufactured in the Engineering Department Electronics Workshop. Using the workshop allowed access to expert support alongside rapid prototyping. Using the engineering workshop meant that there were limitations to the capability of the printer. The holes were not plated through meaning nearly all components could only be connected to the bottom layer. Furthermore, this meant the via’s produced needed to have wires running through them and soldered onto both layers, adding time and complexity to the soldering process. 

Using a soldering iron, I was able to complete two of the three PCBs. I was unable to solder the PCB named SSR-PCB.This is becuase the PCB would be connected to the mains, thereby needing someone qualified to complete the wiring\footnote{This needs to be done by qualified technician, however, due to covid this was not completed}. Figures \ref{fig:base} and \ref{fig:mux} show both sides of the completed PCBs. 

\begin{figure}[h]
\begin{subfigure}{0.5\textwidth}
\includegraphics[width=0.9\linewidth]{Base_front}
\caption{Front View of the PCB named Base.}
\end{subfigure} \begin{subfigure}{0.5\textwidth}
\includegraphics[width=0.9\linewidth]{Base_back}
\caption{Back View of the PCB named Base.}
\end{subfigure}
\caption{The fully built PCB named Base.}
\label{fig:base}
\end{figure}

\begin{figure}[h]
\begin{subfigure}{0.5\textwidth}
\includegraphics[width=0.9\linewidth]{Mux_front}
\caption{Front View of PCB named Solar Multiplexer.}
\end{subfigure} \begin{subfigure}{0.5\textwidth}
\includegraphics[width=0.9\linewidth]{Mux_back}
\caption{Back View of PCB named Solar Multiplexer.}
\end{subfigure}
\caption{The fully built PCB named Solar Multiplexer.}
\label{fig:mux}
\end{figure}



From here the next steps were to connect the PCBs to the substrate holder via the electronic windows. This required careful soldering of wires to ensure no short circuit occurred. To ensure that this was all correctly working testing was done on all the components with the method and results explained in the following chapter. Figure \ref{fig:final} show the PCBs connected together and wired up to the chamber. 

\begin{figure}[h!]
\hfill\includegraphics[width=0.9\linewidth]{final}\hspace*{\fill}
\caption{The chamber fully assembled to the PCBs and Raspberry Pi}
\label{fig:final}
\end{figure}


\section{Code Development}
\label{sec:code_development}

The code development for the system was something that spanned the entire project. The lack of GUI does add slightly more complexity to the user; more importantly however, it does work. 

The method used to combat the increase in complexity is a small introduction at the top of the script explaining where to input the testing conditions and exactly what variables this system is able to change, shown in Figure \ref{fig:code_intro}. 

\begin{figure}[h!]
\hfill\includegraphics[width=1\linewidth]{code_intro}\hspace*{\fill}
\caption{The introduction to the code.}
\label{fig:code_intro}
\end{figure}

The goal of the code was to control the internal environment of the chamber while measuring and storing the current voltage characteristics for analysis. To do this, a Keithley 2400 would be used for these measurements. The advantage of using a Keithley is that it is also able to set a voltage bias across the cells and allow degradation to occur near maximum power point. This aspect is beyond the scope of the project, however, keeping this in mind would help those using it, to create modifications to suit their needs. 

Initial communication issues derailed attempts to use the Keithley 2400 with the Raspberry Pi, therefore the measurements for the leak tests were conducted using a simple multi-meter. \footnote{Due to COVID-19, obtaining a Keithley for the leak tests took time, meaning that the testing of the code was unable to take place till late on in the process. With the code not working, a decision was made to prioritise the chamber testing, with the code being an aspect someone could develop further.} 

One of the important things was to ensure that the data is saved regularly (outside the script) so that if the test is interrupted for any reason (accidental removal, power cut or error) the data that has been collected will be available for recovery and analysis. To do this, at every measurement point the data is saved to a CSV file, thereby insuring that even if the test is compromised, the data will be saved. Furthermore, to ensure that the information container in the CSV file is readable for those outside the group, formatting is also explained in Figure\ref{fig:code_intro}.


\chapter{Chamber Testing and Simulations}
\label{chp:testing}

The tests conducted range from heat and flow simulations to leak testing. The leak and PCB tests are designed to allow the accurate rebuilding of the chamber for other research groups to use. Therefore, this means that the tests conducted should be done with equipment that would \emph{reasonably} be found in laboratories worldwide (glovebox, source meter, simulation software etc.). This chapter outlines all the simulations and tests as well as their results and analysis. 

\section{Heat and Flow Simulations}
\label{sec:sims}

The simulations were undertaken in SOLIDWORKS, this is because it was very simple to run the simulations in the same software as some of the designs. Initially, heat simulations were undertaken. These were designed to emulate the conditions across the substrate and within the substrate holder. The simulations were conducted using SOLIDWORKS heat simulations, where many different conditions could be placed upon the chamber. Both heat and flow simulations were conducted using Finite Element Analysis (FEA). FEA uses numerical methods to solve differential equations by discretising elements to form a mesh. The finer the mesh, the more detailed and accurate the results. However, finer meshes require higher computational powers, meaning that there needs to be a compromise when running the simulations to ensure the clearest picture can be built without using too much computational power. 

When modelling the temperature within the chamber, the FEA used the heat equation, \ref{eq:heat} to find the temperature distribution across the substrate holder, where $U(x,y,z,t)$ is the a the temperature at a given point at a given time. 

\begin{equation}\label{eq:heat}
\frac{\partial U}{\partial t} = \Delta U
\end{equation}

The objective of the heat simulations was to find a heater temperature which would keep the substrate at a steady state temperature of 120$^o$C. The parameters for the initial simulation were as follows: ambient temperature of 25$^o$C, heater temperature 200$^o$C and a convective heat transfer coefficient of 2.5 Wm$^{-2}$L$^{-1}$. The value of 2.5 Wm$^{-2}$L$^{-1}$ was chosen as a lower bound of natural convection from Kosky et al.\cite[p.~264]{RN76}. These values, the test was run with a cylindrical cartridge heater. This simulation was modelling the heat distribution within the chamber. The result shown in Figure \ref{fig:heat_sim_1} shows the temperature variation across the substrate holder. 

\begin{figure}[h!]
\hfill\includegraphics[width=0.7\linewidth]{heat_sim_1}\hspace*{\fill}
\caption{The first heat simulation showing the temperature variation across the substrate holder}
\label{fig:heat_sim_1}
\end{figure}

These simulations were conducted with the substrate holder being made out of PEEK. This is because the safe working temperature range for ABS plastic (which the prototype was made of) is between -20$^o$C and 80$^o$C \cite{RN77}. Furthermore, this thermal simulation has an aluminium plate at point \textbf{a} to ensure that the temperature distribution was uniform below the area the substrate holder would sit. As can be seen, the temperature varies across the substrate holder from a max of 200$^o$C to 80$^o$C, with the aluminium plate having a uniform temperature of 180 $^o$C. To verify the simulation, the equation was simplified to a 1D steady state problem and hand calculations used to ensure that the simulations were resulting in accurate solutions. 

A further simulation was conducted, this time setting the Aluminium plate to 180 $^o$C and modelling the temperature distribution across the substrate. This resulted in the temperature distribution shown in Figure \ref{fig:heat_sim_2}. 

\begin{figure}[h!]
\hfill\includegraphics[width=0.7\linewidth]{heat_sim_2}\hspace*{\fill}
\caption{The second heat simulation showing the temperature distribution across the substrate, the substrate labelled as point \textbf{s}.}
\label{fig:heat_sim_2}
\end{figure}

It can be clearly seen that the substrate (marked at point \textbf{s}) has non uniform temperature distribution. However, the temperature distribution across where the cells would be found (shown in Figure \ref{fig:sub_layout}) illustrates that there is a uniform temperature distribution across the solar cells themselves with a temperature of 120$^o$C. This is the desired temperature for the cells and indicates that a cartridge heater, heated to 200 $^o$C should cause the substrate to be heated up to the temperature set out in the specification. 

As well as heat simulations, flow simulations were also conducted. This was to understand the mechanism in which input gases would flow inside the chamber and around the substrate. SOLIDWORKS flow simulation was used for these simulations. The flow simulations  also used FEA and were solving the Navier-Stokes equations. These use continuity of energy, momentum and mass to define differential equations describing the flow of fluid. The Navier-Stokes equations are significantly more complicated than the heat equation meaning the computation power needed for this modelling was significantly more. Therefore, the mesh used for the flow modelling was more coarse, meaning the results were less accurate. The gas was modelled as an ideal gas, allowing the assumptions of the gas particles having no intermolecular forces and random movement (further simplifying the problem). To understand the movement of the gas particles, the simulation was set up to show the trace of multiple singular particles over a time period of minutes. 

\begin{figure}[h!]
\hfill\includegraphics[width=0.7\linewidth]{flow_sim_1}\hspace*{\fill}
\caption{View 1 of the flow simulations}
\label{fig:flow_sim_1}
\end{figure}

This view shows that there is good mixing around the chamber, however, it is hard to tell the distribution of the input gases around the substrate. Figure \ref{fig:flow_sim_2} shows the view from underneath the substrate with the substrate holder hidden from view. In this view, it is clear that there is minimal direct flow over the cells (which are located on the underside of the substrate). However, there is good mixing away from cell and due to the tests being 1000s of hours, it is assumed that the mixing under the cells will be driven by diffusion. 

\begin{figure}[h!]
\hfill\includegraphics[width=0.5\linewidth]{flow_sim_2}\hspace*{\fill}
\caption{Underneath view of the flow simulations}
\label{fig:flow_sim_2}
\end{figure}

The heat simulations enable the user to understand the cartridge heater temperature needed to heat the substrate to 120$^o$C, while the flow simulations demonstrate the method by which the gases will mix around the chamber and substrate.  

\section{Electrical Testing}
\label{sec:elec_test}

This section discusses the PCB testing, specifically the testing of the code with the PCBs and checking the soldering for any short circuits. 

The first step of the tests was to conduct visual checks on the PCBs to ensure that there are no visible short circuits within the design. This involved using a magnifying glass to verify there were no visible short circuits. Once this was complete, a digital multimeter was utilised to ensure that the resistance between unconnected tracks was unmeasurable as well as checking that the resistance between tracks which are supposed to be connected was minimal (as close to zero as possible). This test discovered 2 small errors where the via’s were not soldered fully, requiring further work to ensure good connections.

Once this was rectified, tests involving the Raspberry Pi were undertaken. Firstly simple connection testing using a multimeter to ensure that the Pi was outputting high or low voltages and the connections between the Pi and the PCBs were at an acceptable standard. Using jumper leads as shown in Figure \ref{fig:jumpers}, the Pi was connected to the PCB named Base (with the schematic shown in the Appendix as Figure \ref{fig:appendix3}) and a multimeter used to check voltages were 5V or 3.3V - depending on which pin the PCB was connected to. 

\begin{figure}[h!]
\hfill\includegraphics[width=0.7\linewidth]{jumpers}\hspace*{\fill}
\caption{The Pi and PCBs connected.}
\label{fig:jumpers}
\end{figure}

Once finished, the following step was to attempt to run some of the code I had written on the PCB. The purpose of the original code is to select a cell for the Keithley 2400 to measure, however, this modified slightly to select a relay to allow current through to light up an LED. Initially, the plan was to use the MCP23S17 (shown in the multiplexer schematic in the Appendix as Figure \ref{fig:appendix4}), however, after some testing this was not working as planned. However, I noticed that the Pi had significantly more Input/Output (I/O) pins than the Arduino that this PCB was originally designed to work with, enabling me to use the ‘extra’ I/O pins to bypass the serial port expander (MCP23S17) creating a simpler code and PCB. 


\begin{figure}[htb!]
\begin{subfigure}{0.5\textwidth}
\includegraphics[width=0.9\linewidth]{sc_1}
\caption{Before image of the Solar Multiplexer}
\label{fig:sc_1}
\end{subfigure} \begin{subfigure}{0.5\textwidth}
\includegraphics[width=0.9\linewidth]{sc_2}
\caption{The Solar Multiplexer after the edits.} 
\label{fig:sc_2}
\end{subfigure}
\caption{The before and after of the editted Solar Multiplexer PCB}
\label{fig:sc}
\end{figure}


This step was only done after PCB manufacturing; therefore, I took the decision to solder wires to \emph{short-circuit} the MCP23S17. The before and after of this can be seen in Figures \ref{fig:sc_1} and \ref{fig:sc_2}. Once this was complete, the test code was run again, this time using the GPIO zero package to switch the SSRs on and off, thereby allowing the LEDs to light up, proving that the code and PCBs worked.

This concluded the testing for the PCBs. These tests were successful as they showed the Raspberry Pi and relays working together as well as illustrating that it would be possible to set all the cells to specific voltage bias for enhanced degradation, followed by the ability to cycle through each one to conduct measurements. 

\section{Leak Testing}
\label{sec:leak}

This section will discuss the leak testing of the chamber. There were two leak tests which were planned: a simple test of placing the chamber in water – to find any large leaks, and a further test which measured the resistance of calcium inside the chamber. 

The water-based leak test was conducted by filling a sink full of water and placing the chamber inside. The first test revealed a hole which I didn’t notice around the electrical windows. A glue gun was used to seal the hole and a hairdryer used to fully dry out the inside. 

Once this was completed the chamber was ready for the calcium test. This test is similar to the one mentioned in Klumbies paper on Encapsulations for Organic Devices \cite{RN78}. The testing procedure was measuring the resistance of calcium deposited on a glass substrate. If the box was leakproof, the calcium wouldn’t degrade as there would be no oxygen and water within the chamber, thereby keeping the resistance low (and the calcium plate shiny). However, if there was a leak, the resistance would increase until the point where the calcium would have oxidised to either CaO or Ca(OH)$_2$, both of which are insulators. 

The plan initially was to use a keithley 2400 to run the tests, this would be done by setting the current to a specific value, then continually measuring and recording the voltage. The setup can be seen below in Figure \ref{fig:calc_test1}.

\begin{figure}[h!]
\hfill\includegraphics[width=0.5\linewidth]{calc_test1}\hspace*{\fill}
\caption{Showing the desired set up for the calcium plate test.}
\label{fig:calc_test1}
\end{figure}

The equations \ref{eq:resistivity} and \ref{eq:voltage} were used to calculate the source current given the minimum voltage which I wanted the keithley 2400 to measure was 0.5 V.

\begin{equation}\label{eq:resistivity}
R = \frac{\rho L}{A}
\end{equation}
\begin{equation}\label{eq:voltage}
V_m = I_s~R\
\end{equation}
Where:
\begin{tabbing}
\phantom{$ P_{diff}\ $}\= \kill
$R$ \>= Resistance of the sample\\
$\rho$ \>= Resistivity of Calcium\\
$A$ \>= Cross sectional area of the sample ($w~t$)\\
$L$ \>= Length of the sample\\
$V_m$ \>= Voltage measured\\
$I_s$ \>= Source current\\
\end{tabbing}
The value of the resistivity of Calcium ranged from 4$\times10^{-8}$ $\Omega$ m to 9$\times10^{-8}$ $\Omega$ m \cite[p.~42]{RN78} (with the lower bound chosen for these calculations), the thickness of the calcium sample was 150 nm, the length and width of the calcium sample was 30 mm. This resulted in a I$_s$ of 1.875 Amps and a minimum power dissipated of 0.93 W.
Once the measurement procedure was decided assembly of the chamber within the glove box occurred. During my first attempt, I realised that the space between the inside edge of the chamber and the substrate holder was very small, thereby preventing me from holding the substrate holder still while attempting to place the calcium plate upon it. This resulted in 2 calcium plate breakages and a redesign of some of the internal components within the chamber. 

To enable easy attachment of the substrate to the substate holder, the decision was taken to use plugs, in this case 3 pairs 9 pin D-sub plugs and sockets. This allowed the substrate holder to be completely removed from the chamber during assembly which helped me hold the substrate holder still while I placed the substrate and lid onto it. The result of which can be seen in Figure \ref{fig:D_sub} below.

\begin{figure}[h!]
\hfill\includegraphics[width=0.7\linewidth]{D_sub}\hspace*{\fill}
\caption{The D-sub plugs connected to the wires exiting the chamber}
\label{fig:D_sub}
\end{figure}

Once this was completed, I attempted to assemble the chamber again. However, there was a problem which prevented the assembly from working as planned. The substrate holder was deformed slightly from the hair dryer and heating required to dry out the porous ABS material. This meant that the substrate no longer sat well inside the substrate holder creating poor electrical connections that would work for a short period of time, but with a tiny bit of disturbance would sever and require a reassembly of the chamber.

To mitigate this, I attempted to order a part made out of PEEK from the engineering department (as mentioned in Section \ref{sec:ICM}), however, the part never arrived. Therefore, I decided to use crocodile clips clipped onto the calcium substrate, to connect it to the wires within the chamber. This worked well with the assembly shown clearly in Figure \ref{fig:calc_test_assembly}.

\begin{figure}[h!]
\hfill\includegraphics[width=0.7\linewidth]{ calc_test_assembly}\hspace*{\fill}
\caption{The calcium test set up using crocodile clips.}
\label{fig:calc_test_assembly}
\end{figure}

From here I measured the resistance of the calcium plate using a multimeter within the chamber. I measured the resistance for 15 minutes and there was no change in that time, with the calcium plate having a resistance of 13 $\Omega$. The Figure \ref{fig:glovebox_c_test} shows the set up with the resistance showing on the multimeter.  

\begin{figure}[h!]
\hfill\includegraphics[width=0.7\linewidth]{glovebox_c_test}\hspace*{\fill}
\caption{The calcium test running, with the first measurement within the glovebox.}
\label{fig:glovebox_c_test}
\end{figure}

After removing the chamber from the glovebox, the resistance started increasing. This was seen on the multimeter, and after 3 hours of running the test, the resistance reached an immeasurable value. This indicated there was a leak in this initial test. To try and find the source of the leak I watched the chamber while it was submerged in water with dissolved washing up liquid\footnote{The washing up liquid reduces the surface tension of the water making bubbles form more easily}. This showed a clear but small leak which were creating bubbles which can be seen rising in Figure \ref{fig:bubbles}.

\begin{figure}[h!]
\begin{subfigure}{0.5\textwidth}
\includegraphics[width=0.9\linewidth]{bubbles1}
\end{subfigure} \begin{subfigure}{0.5\textwidth}
\includegraphics[width=0.9\linewidth]{bubbles2}
\end{subfigure}
\caption{Showing bubbles rising up out of the chamber, while submerged in water mixed with washing up liquid.}
\label{fig:bubbles}
\end{figure}

Once these leaks were filled, a further water test\footnote{Again with washing up liquid} was conducted with no leaks found. Therefore, I conducted another calcium plate test, with the same setup shown previously. However, when the plate was placed within the chamber, while it was in the glovebox, it started to degrade (the measured resistance increasing) to the point where it fully degraded while within the glovebox in the space of 3 hours. Clearly, this is not because of outside air leaking into the chamber, but the most likely reason is that the chamber itself was not fully dried out after using the hairdryer. This means that even with the chamber kept in a vacuum overnight, the water within the chamber did not evaporate and leave, meaning that it was able to degrade the calcium resulting in a failed test before it even started. 

There were no more tests conducted due to a lack of lab time available, meaning that the only leak tests conducted, that were passed, were water-based tests. This, however, is not a failure; the lack of bubbles indicate that if there is a leak, it is very small, meaning that if the user holds the chamber at a slight overpressure (using MFCs), outside air will not be able to enter the chamber allowing the degradation tests to go ahead as planned.\footnote{The reason behind only two calcium leak tests is due to lab regulation surrounding COVID-19. A user could only access the AFMD physics labs for half of a week, meaning that if an experiment takes 2 days to set up (such as leaving the chamber unsealed, in a vacuum overnight, one must wait another week to conduct another one.} 

The chamber was subject to a variety of different tests to prove that it meets the specification. The PCBs work well with the Raspberry-Pi as shown in Section \ref{sec:elec_test}. Furthermore, the heat simulations (in Section \ref{sec:sims} demonstrate that when using the material PEEK for the substrate holder, the cartridge heater should be set to 200$^o$C to heat the substrate (and therefore organic solar cells) to 120$^o$C. The leak tests illustrate that there are no large leaks, yet there is some further work to be conducted to conclusively prove the chamber is leakproof. The Conclusion will outline the further work, including final tests with working organic solar cells. 


\chapter{Conclusion and Future work}

In conclusion, the project has created a chamber with the capability to run controlled degradation experiments of an organic solar cell. The work conducted in Chapter \ref{chp:testing}  illustrates that the set-up designed works well and would be suitable for experimentation with a few modifications, discussed in Section \ref{sec:future}. 

A chamber, was constructed out of Aluminium, with a clear lid and sealing mechanism. The chamber fits within the 150 mm diameter load lock and can be assembled within a glovebox with relative ease. A substrate holder was 3D printed out of a high temperature resin, with a fully functioning mechanism to ensure clean contacting between the cell electrodes and the pins to be inserted. Furthermore, wiring within the chamber was successful in taking electrical connections from inside to the outside of the chamber. 

Additionally, the PCBs were a success, they were able to \emph{choose} a cell\footnote{In the test conducted, an LED} to allow current through as the project required. The gas inlets were leakproof \footnote{This was inspected visually through the water based leak test.} as was the lid mechanism. A functioning code was developed allowing the selection of a cell to measure, while also having the capability to set the cells at a specific voltage bias. The heat simulations illustrate that a cartridge heater is able to heat the substrate to 120$^o$C, while the flow simulations confirmed that to ensure the gases are well mixed within the chamber, the mixing mechanism relied on will be diffusion. 

\section{Future Work}
\label{sec:future}
This section discusses future work tat can be done to ensure the entire set-up works as required. Importantly, further calcium leak tests need to be conducted. This can be with the same procedure as conducted in Section \ref{sec:leak}. From experience of the water based leak tests, the point at where leaks were occurring the most was the outer edge of the electronic windows. An alternative solution would be to use a similar sealing mechanism as used for the lid, where there is an o-ring fitted to each of the electronic windows which are then screwed into place. A model for the alternative part can be seen in Figure\ref{fig:modified}. 
\begin{figure}[h!]
\hfill\includegraphics[width=0.4\linewidth]{modified}\hspace*{\fill}
\caption{Showing an updated model of the electronic window.}
\label{fig:modified}
\end{figure}

Additionally, due to COVID-19 and the resultant extended lead times, the final iteration of the substrate holder was never fully completed. Electrical pins need to be inserted into the pin holes (labelled in Figure \ref{fig:substrate_HT}), then soldered to the wires connected to the D-sub connectors. Once this has been completed a test can be conducted with a LEDs to ensure that current an voltage are being correctly transmitted to the pins. After the successful conclusion of this test, the chamber will be ready for testing a working organic solar cell.

Lastly, further work can be conducted to allow the cells to be monitored using a Keithley 2400. The code developed does not have the capacity to use the Keithley 2400 to measure the organic solar cells. For this to be a function, researchers would need to modify the code, as well as ensure the Raspberry-Pi is set up to work with the Keithley 2400, communicating over either GPIB or RS-232. 

With this work conducted, the set-up should enable researchers to conduct degradation experiments using a accessible system. This will thereby accelerate organic solar cell development worldwide, ensuring the project has an impact in the field of organic solar cell development. 



\pagebreak
\begin{singlespace}
\bibliographystyle{unsrtnat} %also the big one 
\addcontentsline{toc}{chapter}{References}
\bibliography{References}
\end{singlespace}

\appendix
\begin{appendix}
\appendixpage
\addcontentsline{toc}{chapter}{Appendix}
\begin{figure}[h!]
\includegraphics[width=1.4\linewidth, angle=270]{Appendix_1}
\caption{The base schematic provided to me by Dr. Christophoro}
\label{fig:appendix1}
\end{figure}

\begin{figure}[h!]
\includegraphics[width=1.4\linewidth, angle=270]{Appendix_2}
\caption{The multiplexer schematic provided to me by Dr. Christophoro}
\label{fig:appendix2}
\end{figure}

\begin{figure}[h!]
\includegraphics[width=1.4\linewidth, angle=270]{Appendix_3}
\caption{The edited version of the base schematic in Appendix 1 showing the changes I made}
\label{fig:appendix3}
\end{figure}

\begin{figure}[h!]
\includegraphics[width=1.4\linewidth, angle=270]{Appendix_4}
\caption{The edited version of the multiplexer schematic in Appendix 2 showing the changes I made}
\label{fig:appendix4}
\end{figure}

\begin{figure}[h!]
\includegraphics[width=1\linewidth]{Appendix_5}
\caption{The schematic for the PCB which isolated mains from the board named base, used to control the cartridge heater.}
\label{fig:appendix5}
\end{figure}


\begin{figure}[h!]
\includegraphics[width=1.6\linewidth, angle=270]{Gantt}
\caption{A Gantt chart showing the desired timescale for the project}
\label{fig:Gantt}
\end{figure}

\begin{figure}[h!]
\includegraphics[width=1.6\linewidth, angle=270]{Gantt_covid}
\caption{A Gantt chart showing the desired timescale for the project}
\label{fig:Gantt_covid}
\end{figure}

\begin{figure}[h!]
\includegraphics[width=1.4\linewidth, angle=270]{drawing1}
\caption{An engineering drawing in 3rd angle projection showing the outer shell of the chamber}
\label{fig:drawing_1}
\end{figure}

\begin{figure}[h!]
\includegraphics[width=1.4\linewidth, angle=270]{drawing2}
\caption{An engineering drawing in 3rd angle projection showing the outer shell of the chamber}
\label{fig:drawing_2}
\end{figure}

\begin{figure}[h!]
\includegraphics[width=1.4\linewidth, angle=270]{drawing3}
\caption{An engineering drawing in 3rd angle projection showing the metal lid of the chamber}
\label{fig:drawing_3}
\end{figure}


\end{appendix}

\chapter{Risk Assessments}
\begin{figure}[h!]
\hfill\includegraphics[width=0.85\linewidth]{computer_risk_assessment}\hspace*{\fill}
\caption{My computer risk assessment}
\end{figure}

\begin{figure}[h!]
\includegraphics[width=1.4\linewidth, angle=270]{p1_risk_assessment}
\caption{P1 of my risk assessment}
\end{figure}

\begin{figure}[h!]
\includegraphics[width=1.4\linewidth, angle=270]{p2_risk_assessment}
\caption{P2 of my risk assessment}
\end{figure}





\end{document}